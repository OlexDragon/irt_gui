package irt.data.packet.interfaces;

import java.util.Arrays;
import java.util.Optional;

import irt.data.listener.ValueChangeListener;
import irt.data.packet.Packet;
import irt.data.packet.PacketAbstract.Priority;

public interface PacketWork extends Comparable<PacketWork>{

	public static final short PACKET_UNNECESSARY = 0;

	public static final short PACKET_ID_DEVICE_INFO = 1;

	public static final short PACKET_ID_MEASUREMENT_ALL 					= 9,
							PACKET_ID_MEASUREMENT_STATUS 					= 10,
							PACKET_ID_MEASUREMENT_INPUT_POWER				= 11,
							PACKET_ID_MEASUREMENT_BAIAS_25W_OUTPUT_POWER 	= 12,
							PACKET_ID_MEASUREMENT_TEMPERATURE 				= 13,
							PACKET_ID_MEASUREMENT_UNIT_TEMPERATURE			= 14,
							PACKET_ID_MEASUREMENT_CPU_TEMPERATURE			= 15,
							PACKET_ID_MEASUREMENT_5V5 						= 16,
							PACKET_ID_MEASUREMENT_13V2 						= 17,
							PACKET_ID_MEASUREMENT_13V2_NEG					= 18,
							PACKET_ID_MEASUREMENT_OUTPUT_POWER 				= 19,
							PACKET_ID_MEASUREMENT_SNB1_STATUS 				= 180,
							PACKET_ID_MEASUREMENT_SNB2_STATUS 				= 181,
							PACKET_ID_MEASUREMENT_WGS_POSITION 				= 182;

	public static final short 	PACKET_ID_CONFIGURATION_LO		= 20,
								PACKET_ID_CONFIGURATION_LO_FREQUENCIES 		= 21,
								PACKET_ID_CONFIGURATION_MUTE 				= 22,
								PACKET_ID_CONFIGURATION_GAIN				= 23,
								PACKET_ID_CONFIGURATION_GAIN_RANGE 			= 24,
								PACKET_ID_CONFIGURATION_ATTENUATION			= 25,
								PACKET_ID_CONFIGURATION_ATTENUATION_RANGE 	= 26,
								PACKET_ID_CONFIGURATION_FREQUENCY 			= 27,
								PACKET_ID_CONFIGURATION_FREQUENCY_RANGE 	= 28,
								PACKET_ID_STORE_CONFIG						= 29,
								PACKET_ID_CONFIGURATION_FCM_LNB_POWER		= 30,
								PACKET_ID_CONFIGURATION_GAIN_OFFSET			= 31,
								PACKET_ID_CONFIGURATION_FCM_FLAGS 			= 32,
								PACKET_ID_CONFIGURATION_REDUNDANCY_ENABLE	= 33,
								PACKET_ID_CONFIGURATION_REDUNDANCY_MODE		= 34,
								PACKET_ID_CONFIGURATION_REDUNDANCY_NAME		= 35,
								PACKET_ID_CONFIGURATION_REDUNDANCY_STATUS	= 36,
								PACKET_ID_CONFIGURATION_REDUNDANCY_SET_ONLINE= 37,
								PACKET_ID_CONFIGURATION_MUTE_OUTDOOR		= 38,
								PACKET_ID_CONFIGURATION_ALC_ENABLE			= 39,
								PACKET_ID_CONFIGURATION_ALC_ENABLE_COMAND	= 170,
								PACKET_ID_CONFIGURATION_ALC_LEVEL			= 171,
								PACKET_ID_CONFIGURATION_ALC_RANGE			= 172,
								PACKET_ID_CONFIGURATION_DLRS_WGS_SWITCHOVER	= 173,
								PACKET_ID_CONFIGURATION_SET_DLRS_WGS_SWITCHOVER = 174,
								PACKET_ID_CONFIGURATION_SPECTRUM_INVERSION 		= 175,
								PACKET_ID_CONFIGURATION_SET_SPECTRUM_INVERSION 	= 176,
								PACKET_ID_CONFIGURATION_REFERENCE_CONTROL		= 177,
								PACKET_ID_CONFIGURATION_FCM_LNB_REFERENCE		= 178;

	public static final short 	PACKET_ID_FCM_DEVICE_DEBUG_PLL_REG 	= 70;

	public static final short 	PACKET_ID_FCM_ADC_INPUT_POWER 	= 80,
								PACKET_ID_FCM_ADC_OUTPUT_POWER	= 81,
								PACKET_ID_FCM_ADC_TEMPERATURE 	= 82,
								PACKET_ID_FCM_ADC_CURRENT 		= 83,
								PACKET_ID_FCM_ADC_5V5 			= 84,
								PACKET_ID_FCM_ADC_13v2 			= 85,
								PACKET_ID_FCM_ADC_13V2_NEG		= 86;

	public static final short PACKET_ID_PRODUCTION_GENERIC_SET_1_INITIALIZE = 120;

	public static final short PACKET_ID_NETWORK_ADDRESS = 130;


	public static final short 	PACKET_ID_ALARMS_IDs = 140,
								PACKET_ID_ALARMS_SUMMARY			= 141,
								PACKET_ID_ALARMS_OWER_CURRENT		= 142,
								PACKET_ID_ALARMS_UNDER_CURRENT		= 143,
								PACKET_ID_ALARMS_OWER_TEMPERATURE	= 144,
								PACKET_ID_ALARMS_PLL_OUT_OF_LOCK	= 145,
								PACKET_ID_ALARMS_HARDWARE_FAULT		= 146,
								PACKET_ID_ALARMS_REDUNDANT_FAULT	= 147,
								PACKET_ID_ALARMS_test				= 148,
								PACKET_ID_NO_INPUT_SIGNAL 			= 149,
								PACKET_ID_RF_OVERDRIVEL 			= 160;

	public static final short 	PACKET_ID_DEVICE_DEBUG			 		= 1147,

								PACKET_ID_DEVICE_DEBUG_CALIBRATION_MODE 		= PACKET_ID_DEVICE_DEBUG + 0,
								PACKET_ID_DEVICE_DEVICE_DEBUG_CONVERTER_PLL_1 	= PACKET_ID_DEVICE_DEBUG + 1,
								PACKET_ID_DEVICE_DEVICE_DEBUG_CONVERTER_PLL_2 	= PACKET_ID_DEVICE_DEBUG + 2,
								PACKET_ID_DEVICE_DEBUG_DEVICE_INFO				= PACKET_ID_DEVICE_DEBUG + 3,
								PACKET_ID_DEVICE_POTENTIOMETERS_INIT			= PACKET_ID_DEVICE_DEBUG + 4,
								PACKET_ID_DEVICE_DEBUG_HELP 					= PACKET_ID_DEVICE_DEBUG + 5,

								PACKET_ID_DEVICE_FCM_INDEX_1			 		= PACKET_ID_DEVICE_DEBUG + 255,
								//FCM packet IDs mixed index and address
								PACKET_ID_DEVICE_CONVERTER_DAC1_FCM				= PACKET_ID_DEVICE_FCM_INDEX_1 + 1,	// PACKET_ID_DEVICE_FCM_INDEX_1 + address
								PACKET_ID_DEVICE_CONVERTER_DAC2_FCM				= PACKET_ID_DEVICE_FCM_INDEX_1 + 2,
								PACKET_ID_DEVICE_CONVERTER_DAC3_FCM				= PACKET_ID_DEVICE_FCM_INDEX_1 + 3,
								PACKET_ID_DEVICE_CONVERTER_DAC4_FCM				= PACKET_ID_DEVICE_FCM_INDEX_1 + 4,

								//address = 0
								PACKET_ID_DEVICE_DEBUG_ADDR_0			 		= PACKET_ID_DEVICE_FCM_INDEX_1 + 255,
								PACKET_ID_DEVICE_DEBUG_POTENTIOMETER_N2 		= PACKET_ID_DEVICE_DEBUG_ADDR_0 + 1,	//PACKET_ID_DEVICE_DEBUG_ADDR_0 + index
								PACKET_ID_DEVICE_DEBUG_POTENTIOMETER_N5 		= PACKET_ID_DEVICE_DEBUG_ADDR_0 + 2,
								PACKET_ID_DEVICE_DEBUG_POTENTIOMETER_N4 		= PACKET_ID_DEVICE_DEBUG_ADDR_0 + 7,


								//address = 1
								PACKET_ID_DEVICE_DEBUG_ADDR_1			 		= PACKET_ID_DEVICE_DEBUG_ADDR_0 + 255,
								PACKET_ID_DEVICE_DEBUG_SWITCH_N1		 		= PACKET_ID_DEVICE_DEBUG_ADDR_1 + 3,	//PACKET_ID_DEVICE_DEBUG_ADDR_1 + index
								PACKET_ID_DEVICE_DEBUG_SWITCH_N2				= PACKET_ID_DEVICE_DEBUG_ADDR_1 + 4,
								PACKET_ID_DEVICE_DEBUG_HS1_CURRENT 				= PACKET_ID_DEVICE_DEBUG_ADDR_1 + 5,
								PACKET_ID_DEVICE_DEBUG_NGLOBAL 					= PACKET_ID_DEVICE_DEBUG_ADDR_1 + 6,
								PACKET_ID_DEVICE_DEBUG_SWITCH_N1_REMOTE_BIAS	= PACKET_ID_DEVICE_DEBUG_ADDR_1 + 203,
								PACKET_ID_DEVICE_DEBUG_SWITCH_N2_REMOTE_BIAS	= PACKET_ID_DEVICE_DEBUG_ADDR_1 + 204,
								PACKET_ID_DEVICE_DEBUG_HS1_CURRENT_REMOTE_BIAS	= PACKET_ID_DEVICE_DEBUG_ADDR_1 + 205,
								PACKET_ID_DEVICE_DEBUG_NGLOBAL_REMOTE_BIAS 		= PACKET_ID_DEVICE_DEBUG_ADDR_1 + 206,

								//address = 2
								PACKET_ID_DEVICE_DEBUG_ADDR_2			 		= PACKET_ID_DEVICE_DEBUG_ADDR_1 + 255,
								PACKET_ID_DEVICE_DEBUG_HS2_CURRENT 				= PACKET_ID_DEVICE_DEBUG_ADDR_2 + 5,	//PACKET_ID_DEVICE_DEBUG_ADDR_2 + index
								PACKET_ID_DEVICE_DEBUG_HS2_CURRENT_REMOTE_BIAS	= PACKET_ID_DEVICE_DEBUG_ADDR_2 + 205,

								//address = 3
								PACKET_ID_DEVICE_DEBUG_ADDR_3			 		= PACKET_ID_DEVICE_DEBUG_ADDR_2 + 255,
								PACKET_ID_DEVICE_DEBUG_POTRNTIOMETER_N2_SET 	= PACKET_ID_DEVICE_DEBUG_ADDR_3 + 1,	//PACKET_ID_DEVICE_DEBUG_ADDR_3 + index
								PACKET_ID_DEVICE_DEBUG_POTRNTIOMETER_N5_SET		= PACKET_ID_DEVICE_DEBUG_ADDR_3 + 2,
								PACKET_ID_DEVICE_DEBUG_OUTPUT_POWER 			= PACKET_ID_DEVICE_DEBUG_ADDR_3 + 5,
								PACKET_ID_DEVICE_DEBUG_POTRNTIOMETER_N4_SET		= PACKET_ID_DEVICE_DEBUG_ADDR_3 + 7,

								//address = 4
								PACKET_ID_DEVICE_DEBUG_ADDR_4			 		= PACKET_ID_DEVICE_DEBUG_ADDR_3 + 255,
								PACKET_ID_DEVICE_DEBUG_TEMPERATURE 				= PACKET_ID_DEVICE_DEBUG_ADDR_4 + 5,	//PACKET_ID_DEVICE_DEBUG_ADDR_4 + index
								PACKET_ID_DEVICE_DEBUG_TEMPERATURE_REMOTE_BIAS	= PACKET_ID_DEVICE_DEBUG_ADDR_4 + 205,

								//address = 8
								PACKET_ID_DEVICE_DEBUG_ADDR_8			 		= PACKET_ID_DEVICE_DEBUG_ADDR_4 + 255,
								PACKET_ID_DEVICE_DEBUG_POTENTIOMETER_N1 		= PACKET_ID_DEVICE_DEBUG_ADDR_8 + 1,	//PACKET_ID_DEVICE_DEBUG_ADDR_8 + index
								PACKET_ID_DEVICE_DEBUG_POTENTIOMETER_N6 		= PACKET_ID_DEVICE_DEBUG_ADDR_8 + 2,
								PACKET_ID_DEVICE_DEBUG_POTENTIOMETER_N3 		= PACKET_ID_DEVICE_DEBUG_ADDR_8 + 7,

								//address = 11
								PACKET_ID_DEVICE_DEBUG_ADDR_11			 		= PACKET_ID_DEVICE_DEBUG_ADDR_8 + 255,
								PACKET_ID_DEVICE_DEBUG_POTRNTIOMETER_N1_SET 	= PACKET_ID_DEVICE_DEBUG_ADDR_11 + 1,	//PACKET_ID_DEVICE_DEBUG_ADDR_11 + index
								PACKET_ID_DEVICE_DEBUG_POTRNTIOMETER_N3_SET		= PACKET_ID_DEVICE_DEBUG_ADDR_11 + 2,
								PACKET_ID_DEVICE_DEBUG_POTRNTIOMETER_N6_SET		= PACKET_ID_DEVICE_DEBUG_ADDR_11 + 7,

								//address = 100
								PACKET_ID_DEVICE_DEBUG_ADDR_100			 		= PACKET_ID_DEVICE_DEBUG_ADDR_11 + 255,
								PACKET_ID_DEVICE_CONVERTER_DAC1 				= PACKET_ID_DEVICE_DEBUG_ADDR_100 + 1,	//PACKET_ID_DEVICE_DEBUG_ADDR_100 + index
								PACKET_ID_DEVICE_CONVERTER_DAC2 				= PACKET_ID_DEVICE_DEBUG_ADDR_100 + 2,
								PACKET_ID_DEVICE_CONVERTER_DAC3 				= PACKET_ID_DEVICE_DEBUG_ADDR_100 + 3,
								PACKET_ID_DEVICE_CONVERTER_DAC4 				= PACKET_ID_DEVICE_DEBUG_ADDR_100 + 4;

	//Dumps to file
		public static final short	DUMPS										= PACKET_ID_DEVICE_DEBUG_ADDR_100 + 255,	// Start of dump indexes
									PACKET_ID_DUMP_DEVICE_DEBUG_DEVICE_INFO_0	= DUMPS + 0,	//Index 0.  Board info, like: CPU frequency, CPU reset type, CPU clock source, Local temperature
									PACKET_ID_DUMP_DEVICE_DEBUG_DEVICE_INFO_1	= DUMPS + 1,	//Index 1.  Board error info
									PACKET_ID_DUMP_DEVICE_DEBUG_DEVICE_INFO_2	= DUMPS + 2,	//Index 2.  Threshold info, like:  Zero current, Over-current HSS1, Over-current HSS2, Over-temperature mute, Over-temperature unmute
									PACKET_ID_DUMP_DEVICE_DEBUG_DEVICE_INFO_3	= DUMPS + 3,	//Index 3.  I2C error statistics
									PACKET_ID_DUMP_DEVICE_DEBUG_DEVICE_INFO_4	= DUMPS + 4,	//Index 4.  Mute state machine flags in format: Flag_name: Current_flag (History_flag)
									PACKET_ID_DUMP_DEVICE_DEBUG_DEVICE_INFO_10	= DUMPS + 10,	//Index 10.  FCM info
									PACKET_ID_DUMP_DEVICE_DEBUG_DEVICE_INFO_11	= DUMPS + 11,	//Index 11. 
									PACKET_ID_DUMP_POWER						= DUMPS + 24,

									DEVICES										= DUMPS + 250,
									PACKET_ID_CLEAR_STATISTICS 					= DEVICES + 0,
									PACKET_ID_DUMP_REGISTER_1					= DEVICES + 1,
									PACKET_ID_DUMP_REGISTER_2					= DEVICES + 2,
									PACKET_ID_DUMP_REGISTER_3					= DEVICES + 3,
									PACKET_ID_DUMP_REGISTER_4					= DEVICES + 4,
									PACKET_ID_DUMP_REGISTER_5					= DEVICES + 5,
									PACKET_ID_DUMP_REGISTER_6					= DEVICES + 6,
									PACKET_ID_DUMP_REGISTER_7					= DEVICES + 7,
									PACKET_ID_DUMP_REGISTER_10					= DEVICES + 10,
									PACKET_ID_DUMP_REGISTER_100					= DEVICES + 100,
									PACKET_ID_DUMP_REGISTER_201					= DEVICES + 201,
									PACKET_ID_DUMP_REGISTER_202					= DEVICES + 202,
									PACKET_ID_DUMP_REGISTER_207					= DEVICES + 207,
									PACKET_ID_DUMP_REGISTER_220					= DEVICES + 220;

	public enum AlarmsPacketIds{

		INDEFINED				((byte) 0, PACKET_UNNECESSARY),
		PLL_OUT_OF_LOCK			((byte) 1, PACKET_ID_ALARMS_PLL_OUT_OF_LOCK),
		TEMPERATURE_ThRESHOLD_1	((byte) 2, PACKET_ID_ALARMS_PLL_OUT_OF_LOCK),
		TEMPERATURE_ThRESHOLD_2	((byte) 3, PACKET_ID_ALARMS_PLL_OUT_OF_LOCK),
		OVER_CURRENT_ALARM		((byte) 4, PACKET_ID_ALARMS_OWER_CURRENT),
		UNDER_CURRENT_ALARM		((byte) 5, PACKET_ID_ALARMS_UNDER_CURRENT),
		ALC_ERROR				((byte) 6, PACKET_ID_ALARMS_UNDER_CURRENT),
		OVER_TEMPERATURE_ALARM	((byte) 7, PACKET_ID_ALARMS_OWER_TEMPERATURE),
		HW_FAULT				((byte)10, PACKET_ID_ALARMS_HARDWARE_FAULT),
		REDUNDANCY_FAULT		((byte)11, PACKET_ID_ALARMS_REDUNDANT_FAULT),
		RF_OVERDRIVE			((byte)12, PACKET_ID_RF_OVERDRIVEL);

		private short alarmId;
		private short packetId;

		public short getPacketId() {
			return packetId;
		}

		private AlarmsPacketIds(short alarmId, short packetId){
			this.alarmId = alarmId;
			this.packetId = packetId;
		}

		public static Optional<AlarmsPacketIds> valueOf(short alarmId){
//			LogManager.getLogger().error(alarmId);
			return Arrays.stream(values()).parallel().filter(a->a.alarmId==alarmId).findAny();
		}
	}

	public static final short	PACKET_ID_PROTOCOL_ADDRESS	= 150;

	/*		reserved for configuration from 170 to 179		*/
	/*		reserved for measurement from 180 to 189		*/

	public Priority 			getPriority();
	public PacketThreadWorker 	getPacketThread();
	public void 				addVlueChangeListener(ValueChangeListener valueChangeListener);
	public void 				removeVlueChangeListener(ValueChangeListener valuechangelistener);
	public boolean 				set(Packet packet);
	public void 				clear();
	public void 				removeVlueChangeListeners();
	public boolean 				isAddressEquals(Packet packet);
}
