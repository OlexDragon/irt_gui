package irt.data.packet;

import java.nio.ByteBuffer;
import java.util.Arrays;
import java.util.Optional;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import irt.data.packet.denice_debag.DeviceDebugPacket.DeviceDebugType;

public enum DeviceDebugPacketIds{
		
		ADDR_0						(0		, 0		, PacketID.DEVICE_DEBUG_ADDR_0					, "DEVICE_DEBUG_ADDR_0"				),
		ADDR_1						(0		, 0		, PacketID.DEVICE_DEBUG_ADDR_1					, "DEVICE_DEBUG_ADDR_1"				),
		ADDR_2						(0		, 0		, PacketID.DEVICE_DEBUG_ADDR_2					, "DEVICE_DEBUG_ADDR_2"				),
		ADDR_3						(0		, 0		, PacketID.DEVICE_DEBUG_ADDR_3					, "DEVICE_DEBUG_ADDR_3"				),
		ADDR_4						(0		, 0		, PacketID.DEVICE_DEBUG_ADDR_4					, "DEVICE_DEBUG_ADDR_4"				),
		ADDR_8						(0		, 0		, PacketID.DEVICE_DEBUG_ADDR_8					, "DEVICE_DEBUG_ADDR_8"				),
		ADDR_11						(0		, 0		, PacketID.DEVICE_DEBUG_ADDR_11				, "DEVICE_DEBUG_ADDR_11"			),
		ADDR_100					(0		, 0		, PacketID.DEVICE_DEBUG_ADDR_100				, "DEVICE_DEBUG_ADDR_100"			),
		CALIBRATION_MODE			(0		, 0		, PacketID.DEVICE_DEBUG_CALIBRATION_MODE		, "DEVICE_DEBUG_CALIBRATION_MODE"	),

		INFO						(null	, null	, PacketID.DEVICE_DEBUG_INFO					, "DEVICE_DEBUG_DEVICE_INFO"		),
		DUMP_CONVERTER_INFO			(null	, 10	, PacketID.DEVICE_DEBUG_CONVERTER_INFO_DUMP	, "DUMP_CONVERTER_INFO"				),

		CPU_INFO					(null	, 0		, PacketID.DEVICE_DEBUG_CPU_INFO				, "DEVICE_DEBUG_CPU_INFO"			),
		HARDWARE_FAULTS_INFO		(null	, 1		, PacketID.DEVICE_DEBUG_HARDWARE_FAULTS_INFO	, "DEVICE_DEBUG_HARDWARE_FAULTS_INFO"),
		THRESHOLDS_INFO				(null	, 2		, PacketID.DEVICE_DEBUG_THRESHOLDS_INFO		, "DEVICE_DEBUG_THRESHOLDS_INFO"	),
		I2C1_INFO					(null	, 3		, PacketID.DEVICE_DEBUG_I2C1_INFO				, "DEVICE_DEBUG_I2C1_INFO"			),
		MUTE_INFO					(null	, 4		, PacketID.DEVICE_DEBUG_MUTE_INFO				, "DEVICE_DEBUG_MUTE_INFO"			),
		SCP_DEVICE_INFO				(null	, 10	, PacketID.DEVICE_DEBUG_SCP_DEVICE_INFO		, "DEVICE_DEBUG_SCP_DEVICE_INFO"	),

//		INFO_0					(0, 0, PacketIDs.DUMP_DEVICE_DEBUG_INFO_0				, "DUMP_DEVICE_DEBUG_INFO_0"			, PacketImp.PARAMETER_DEVICE_DEBUG_READ_WRITE),
//		INFO_1					(0, 1, PacketIDs.DUMP_DEVICE_DEBUG_INFO_1				, "DUMP_DEVICE_DEBUG_INFO_1"			, PacketImp.PARAMETER_DEVICE_DEBUG_READ_WRITE),
//		INFO_2					(0, 2, PacketIDs.DUMP_DEVICE_DEBUG_INFO_2				, "DUMP_DEVICE_DEBUG_INFO_2"			, PacketImp.PARAMETER_DEVICE_DEBUG_READ_WRITE),
//		INFO_3					(0, 3, PacketIDs.DUMP_DEVICE_DEBUG_INFO_3				, "DUMP_DEVICE_DEBUG_INFO_3"			, PacketImp.PARAMETER_DEVICE_DEBUG_READ_WRITE),
//		INFO_4					(0, 4, PacketIDs.DUMP_DEVICE_DEBUG_INFO_4				, "DUMP_DEVICE_DEBUG_INFO_4"			, PacketImp.PARAMETER_DEVICE_DEBUG_READ_WRITE),
//		INFO_10					(0, 10, PacketIDs.DUMP_DEVICE_DEBUG_INFO_10				, "DUMP_DEVICE_DEBUG_INFO_10"			, PacketImp.PARAMETER_DEVICE_DEBUG_READ_WRITE),
//		INFO_11					(0, 11, PacketIDs.DUMP_DEVICE_DEBUG_INFO_11				, "DUMP_DEVICE_DEBUG_INFO_11"			, PacketImp.PARAMETER_DEVICE_DEBUG_READ_WRITE),

		DEVICEs_DUMP				(null	, 100	, PacketID.DEVICE_DEBUG_DEVICEs_DUMP			, "DEVICE_DEBUG_DEVICEs_DUMP"		),
		DEVICE1_DUMP				(null	, 1		, PacketID.DEVICE_DEBUG_DEVICE1_DUMP			, "DEVICE_DEBUG_DEVICE1_DUMP"		),
		DEVICE2_DUMP				(null	, 2		, PacketID.DEVICE_DEBUG_DEVICE2_DUMP			, "DEVICE_DEBUG_DEVICE2_DUMP"		),
		DEVICE3_DUMP				(null	, 7		, PacketID.DEVICE_DEBUG_DEVICE3_DUMP			, "DEVICE_DEBUG_DEVICE3_DUMP"		),
		HSS1_DUMP					(null	, 3		, PacketID.DEVICE_DEBUG_HSS1_DUMP				, "DEVICE_DEBUG_HSS1_DUMP"			),
		HSS2_DUMP					(null	, 4		, PacketID.DEVICE_DEBUG_HSS2_DUMP				, "DEVICE_DEBUG_HSS2_DUMP"			),
		VOLTAGES_DUMP				(null	, 5		, PacketID.DEVICE_DEBUG_VOLTAGES_DUMP			, "DEVICE_DEBUG_VOLTAGES_DUMP"		),
		PLL2_DUMP					(null	, 6		, PacketID.DEVICE_DEBUG_PLL2_DUMP				, "DEVICE_DEBUG_PLL2_DUMP"			),
		ADC_CHANNELS_DUMP			(null	, 10	, PacketID.DEVICE_DEBUG_ADC_CHANNELS_DUMP		, "DEVICE_DEBUG_ADC_CHANNELS_DUMP"	),
		ADC_CHANNELS_mV_DUMP		(null	, 11	, PacketID.DEVICE_DEBUG_ADC_CHANNELS_mV_DUMP	, "DEVICE_DEBUG_ADC_CHANNELS_mV_DUMP"),
		SIGNALS_CHANGE_COUNTERS_DUMP(null	, 20	, PacketID.DEVICE_DEBUG_CHANGE_COUNTERS_DUMP	, "DEVICE_DEBUG_CHANGE_COUNTERS_DUMP"),
		DP1_DUMP					(null	, 30	, PacketID.DEVICE_DEBUG_DP1_DUMP				, "DEVICE_DEBUG_DP1_DUMP"			),

		HELP						(0		, 0		, PacketID.DEVICE_DEBUG_HELP					, "DEVICE_DEBUG_HELP"				),

		HS1_CURRENT					(1		, 5		, PacketID.DEVICE_DEBUG_HS1_CURRENT			, "DEVICE_DEBUG_HS1_CURRENT"		),
		HS1_CURRENT_REMOTE_BIAS		(1		, 205	, PacketID.DEVICE_DEBUG_HS1_CURRENT_REMOTE_BIAS, "DEVICE_DEBUG_HS1_CURRENT_REMOTE_BIAS"),
		HS1_1_CURRENT_HP_BIAS		(16		, 20	, PacketID.DEVICE_DEBUG_HS1_1_CURRENT_HP_BIAS	, "DEVICE_DEBUG_HS1_1_CURRENT"		),
		HS1_2_CURRENT_HP_BIAS		(17		, 20	, PacketID.DEVICE_DEBUG_HS1_2_CURRENT_HP_BIAS	, "DEVICE_DEBUG_HS1_2_CURRENT"		),
//		HS1_CURRENT_HP_BIAS_REMOTE	(0		, 0		, PacketIDs.DEVICE_DEBUG_HS1_CURRENT			, "DEVICE_DEBUG_HS1_CURRENT"		),
		HS2_CURRENT					(2		, 5		, PacketID.DEVICE_DEBUG_HS2_CURRENT			, "DEVICE_DEBUG_HS2_CURRENT"		),
		HS2_CURRENT_REMOTE_BIAS		(2		, 205	, PacketID.DEVICE_DEBUG_HS2_CURRENT_REMOTE_BIAS, "DEVICE_DEBUG_HS2_CURRENT_REMOTE_BIAS"),
		HS2_1_CURRENT_HP_BIAS		(18		, 20	, PacketID.DEVICE_DEBUG_HS2_1_CURRENT_HP_BIAS	, "DEVICE_DEBUG_HS2_1_CURRENT_HP_BIAS"),
		HS2_2_CURRENT_HP_BIAS		(19		, 20	, PacketID.DEVICE_DEBUG_HS2_2_CURRENT_HP_BIAS	, "DEVICE_DEBUG_HS2_2_CURRENT_HP_BIAS"),
		HS3_1_CURRENT_HP_BIAS		(20		, 20	, PacketID.DEVICE_DEBUG_HS3_1_CURRENT_HP_BIAS	, "DEVICE_DEBUG_HS3_1_CURRENT_HP_BIAS"),
		HS3_2_CURRENT_HP_BIAS		(21		, 20	, PacketID.DEVICE_DEBUG_HS3_2_CURRENT_HP_BIAS	, "DEVICE_DEBUG_HS3_2_CURRENT_HP_BIAS"),
		HS4_1_CURRENT_HP_BIAS		(22		, 20	, PacketID.DEVICE_DEBUG_HS4_1_CURRENT_HP_BIAS	, "DEVICE_DEBUG_HS4_1_CURRENT_HP_BIAS"),
		HS4_2_CURRENT_HP_BIAS		(23		, 20	, PacketID.DEVICE_DEBUG_HS4_2_CURRENT_HP_BIAS	, "DEVICE_DEBUG_HS4_2_CURRENT_HP_BIAS"),

		OUTPUT_POWER				(3		, 5		, PacketID.DEVICE_DEBUG_OUTPUT_POWER			, "DEVICE_DEBUG_OUTPUT_POWER"		),
		OUTPUT_POWER_REMOTE_BIAS	(3		, 205	, PacketID.DEVICE_DEBUG_OUTPUT_POWER_REMOTE_BIAS, "DEVICE_DEBUG_OUTPUT_POWER_REMOTE_BIAS"),
		OUTPUT_POWER_HP_BIAS		(0		, 20	, PacketID.DEVICE_DEBUG_OUTPUT_POWER_HP_BIAS	, "DEVICE_DEBUG_OUTPUT_POWER_HP_BIAS"),

		TEMPERATURE					(4		, 5		, PacketID.DEVICE_DEBUG_TEMPERATURE			, "DEVICE_DEBUG_TEMPERATURE"		),
		TEMPERATURE_REMOTE_BIAS		(4		, 205	, PacketID.DEVICE_DEBUG_TEMPERATURE_REMOTE_BIAS, "DEVICE_DEBUG_TEMPERATURE_REMOTE_BIAS"),
		TEMPERATURE_HP_BIAS			(4		, 20	, PacketID.DEVICE_DEBUG_TEMPERATURE_HP_BIAS	, "DEVICE_DEBUG_TEMPERATURE_HP_BIAS"),

		NGLOBAL						(0		, 6		, PacketID.DEVICE_DEBUG_NGLOBAL				, "DEVICE_DEBUG_NGLOBAL"			),
		NGLOBAL_REMOTE_BIAS			(0		, 206	, PacketID.DEVICE_DEBUG_NGLOBAL_REMOTE_BIAS	, "DEVICE_DEBUG_NGLOBAL_REMOTE_BIAS"),

		POTENTIOMETER_N1		(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N1		, "DEVICE_DEBUG_POTENTIOMETER_N1"	),
		POTENTIOMETER_N2		(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N2		, "DEVICE_DEBUG_POTENTIOMETER_N2"	),
		POTENTIOMETER_N3		(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N3		, "DEVICE_DEBUG_POTENTIOMETER_N3"	),
		POTENTIOMETER_N4		(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N4		, "DEVICE_DEBUG_POTENTIOMETER_N4"	),
		POTENTIOMETER_N5		(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N5		, "DEVICE_DEBUG_POTENTIOMETER_N5"	),
		POTENTIOMETER_N6		(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N6		, "DEVICE_DEBUG_POTENTIOMETER_N6"	),
		POTENTIOMETER_N1_SET	(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N1_SET	, "DEVICE_DEBUG_POTENTIOMETER_N1_SET"),
		POTENTIOMETER_N2_SET	(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N2_SET	, "DEVICE_DEBUG_POTENTIOMETER_N2_SET"),
		POTENTIOMETER_N3_SET	(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N3_SET	, "DEVICE_DEBUG_POTENTIOMETER_N3_SET"),
		POTENTIOMETER_N4_SET	(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N4_SET	, "DEVICE_DEBUG_POTENTIOMETER_N4_SET"),
		POTENTIOMETER_N5_SET	(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N5_SET	, "DEVICE_DEBUG_POTENTIOMETER_N5_SET"),
		POTENTIOMETER_N6_SET	(0		, 0		, PacketID.DEVICE_DEBUG_POTENTIOMETER_N6_SET	, "DEVICE_DEBUG_POTENTIOMETER_N6_SET"),
		SWITCH_N1				(1		, 3		, PacketID.DEVICE_DEBUG_SWITCH_N1				, "DEVICE_DEBUG_SWITCH_N1"			),
		SWITCH_N1_REMOTE_BIAS	(1		, 203	, PacketID.DEVICE_DEBUG_SWITCH_N1_REMOTE_BIAS	, "DEVICE_DEBUG_SWITCH_N1_REMOTE_BIAS"),
		SWITCH_N2				(1		, 4		, PacketID.DEVICE_DEBUG_SWITCH_N2				, "DEVICE_DEBUG_SWITCH_N2"			),
		SWITCH_N2_REMOTE_BIAS	(1		, 204	, PacketID.DEVICE_DEBUG_SWITCH_N2_REMOTE_BIAS	, "DEVICE_DEBUG_SWITCH_N2_REMOTE_BIAS"),
		CONVERTER_PLL_1			(0, 0, PacketID.DEVICE_DEBUG_CONVERTER_PLL_1			, "DEVICE_DEBUG_CONVERTER_PLL_1"	),
		CONVERTER_PLL_2			(0, 0, PacketID.DEVICE_DEBUG_CONVERTER_PLL_2			, "DEVICE_DEBUG_CONVERTER_PLL_2"	),

		PLL_REG					(0, 0, PacketID.FCM_DEVICE_DEBUG_PLL_REG				, "FCM_DEVICE_DEBUG_PLL_REG"		),
		PLL_REG_DOWN_GAIN		(0, 0, PacketID.FCM_DEVICE_DEBUG_PLL_REG_DOWN_GAIN	, "FCM_DEVICE_DEBUG_PLL_REG_DOWN_GAIN"	),
		PLL_REG_UP_GAIN			(0, 0, PacketID.FCM_DEVICE_DEBUG_PLL_REG_UP_GAIN		, "FCM_DEVICE_DEBUG_PLL_REG_UP_GAIN"),
		PLL_REG_OFFSET			(0, 0, PacketID.FCM_DEVICE_DEBUG_PLL_REG_OFFSET		, "FCM_DEVICE_DEBUG_PLL_REG_OFFSET"	),

		FCM_R31_ADC_INPUT_POWER	(15, 10	, PacketID.FCM_ADC_INPUT_POWER					, "FCM_ADC_INPUT_POWER"				),
		FCM_R31_ADC_OUTPUT_POWER( 9, 14	, PacketID.FCM_ADC_OUTPUT_POWER				, "FCM_ADC_OUTPUT_POWER"			),
		FCM_R31_ADC_TEMPERATURE	( 8, 10	, PacketID.FCM_ADC_TEMPERATURE					, "FCM_ADC_TEMPERATURE"				),
		FCM_R31_ADC_CLKREF_LVL	(11, 10	, PacketID.FCM_ADC_CLKREF_LVL					, "FCM_ADC_CLKREF_LVL"				),
		FCM_R31_ADC_5V5			( 3, 10	, PacketID.FCM_ADC_5V5							, "FCM_ADC_5V5"						),

		FCM_R31_ADC_INPUT_POWER_mV	(15, 11	, PacketID.FCM_ADC_INPUT_POWER				, "FCM_ADC_INPUT_POWER_mV"			),
		FCM_R31_ADC_OUTPUT_POWER_mV	( 9, 15	, PacketID.FCM_ADC_OUTPUT_POWER			, "FCM_ADC_OUTPUT_POWER_mV"			),
		FCM_R31_ADC_TEMPERATURE_mV	( 8, 11	, PacketID.FCM_ADC_TEMPERATURE				, "FCM_ADC_TEMPERATURE_mV"			),
		FCM_R31_ADC_CLKREF_LVL_mV	(11, 11	, PacketID.FCM_ADC_CLKREF_LVL				, "FCM_ADC_CLKREF_LVL_mV"			),
		FCM_R31_ADC_5V5_mV			( 3, 11	, PacketID.FCM_ADC_5V5						, "FCM_ADC_5V5_mV"					),

		FCM_ADC_INPUT_POWER		(0, 10	, PacketID.FCM_ADC_INPUT_POWER					, "FCM_ADC_INPUT_POWER"				),
		FCM_ADC_OUTPUT_POWER	(1, 10	, PacketID.FCM_ADC_OUTPUT_POWER				, "FCM_ADC_OUTPUT_POWER"			),
		FCM_ADC_TEMPERATURE		(2, 10	, PacketID.FCM_ADC_TEMPERATURE					, "FCM_ADC_TEMPERATURE"				),
		FCM_ADC_CURRENT			(4, 10	, PacketID.FCM_ADC_CURRENT						, "FCM_ADC_CURRENT"					),
		FCM_ADC_5V5				(6, 10	, PacketID.FCM_ADC_5V5							, "FCM_ADC_5V5"						),
		FCM_ADC_13v2			(7, 10	, PacketID.FCM_ADC_13v2						, "FCM_ADC_13v2"					),
		FCM_ADC_13V2_NEG		(8, 10	, PacketID.FCM_ADC_13V2_NEG					, "FCM_ADC_13V2_NEG"				),

		FCM_ADC_INPUT_POWER_mV	(0, 11	, PacketID.FCM_ADC_INPUT_POWER					, "FCM_ADC_INPUT_POWER_mV"			),
		FCM_ADC_OUTPUT_POWER_mV	(1, 11	, PacketID.FCM_ADC_OUTPUT_POWER				, "FCM_ADC_OUTPUT_POWER_mV"			),
		FCM_ADC_TEMPERATURE_mV	(2, 11	, PacketID.FCM_ADC_TEMPERATURE					, "FCM_ADC_TEMPERATURE_mV"			),
		FCM_ADC_CURRENT_mV		(4, 11	, PacketID.FCM_ADC_CURRENT						, "FCM_ADC_CURRENT_mV"				),
		FCM_ADC_5V5_mV			(6, 11	, PacketID.FCM_ADC_5V5							, "FCM_ADC_5V5_mV"					),
		FCM_ADC_13v2_mV			(7, 11	, PacketID.FCM_ADC_13v2						, "FCM_ADC_13v2_mV"					),
		FCM_ADC_13V2_NEG_mV		(8, 11	, PacketID.FCM_ADC_13V2_NEG					, "FCM_ADC_13V2_NEG_mV"				),

		DAC1					(0, 1	, PacketID.DEVICE_CONVERTER_DAC1				, "DEVICE_CONVERTER_DAC1"			),	// PACKET_ID_DEVICE_FCM_INDEX_1 + address
		DAC2					(0, 2	, PacketID.DEVICE_CONVERTER_DAC2				, "DEVICE_CONVERTER_DAC2"			),
		DAC3					(0, 3	, PacketID.DEVICE_CONVERTER_DAC3				, "DEVICE_CONVERTER_DAC3"			),
		DAC4					(0, 4	, PacketID.DEVICE_CONVERTER_DAC4				, "DEVICE_CONVERTER_DAC4"			),

		FCM_DAC1				(0, 1	, PacketID.DEVICE_CONVERTER_DAC1_FCM			, "DEVICE_CONVERTER_DAC1_FCM"		),	// PACKET_ID_DEVICE_FCM_INDEX_1 + address
		FCM_DAC2				(0, 2	, PacketID.DEVICE_CONVERTER_DAC2_FCM			, "DEVICE_CONVERTER_DAC2_FCM"		),
		FCM_DAC3				(0, 3	, PacketID.DEVICE_CONVERTER_DAC3_FCM			, "DEVICE_CONVERTER_DAC3_FCM"		),
		FCM_DAC4				(0, 4	, PacketID.DEVICE_CONVERTER_DAC4_FCM			, "DEVICE_CONVERTER_DAC4_FCM"		);

		private static final int INDEX = 2;
		private static final int ADDR = 1;

		private final static Logger logger = LogManager.getLogger();
		private final PacketID packetId;
		private final String text;
		private final Integer addr;
		private final Integer index;

		private DeviceDebugPacketIds(Integer index, Integer addr, PacketID packetId, String text){

			this.addr = addr;
			this.index = index;
			this.packetId = packetId;
			this.text = text;
		}

		public byte[] getPayloadData() {
			int caseIndex = 0;

			if(index!=null)
				caseIndex += ADDR;

			if(addr!=null)
				caseIndex += INDEX;

			switch(caseIndex){

			case ADDR:
				return ByteBuffer.allocate(4).putInt(index).array();

			case INDEX:
				return ByteBuffer.allocate(4).putInt(addr).array();

			case ADDR + INDEX:
				return ByteBuffer.allocate(8).putInt(addr).putInt(index).array();
			}
			return null;
		}

		public PacketID getPacketId() {
			return packetId;
		}

		public static Optional<DeviceDebugPacketIds> valueOf(short id){
			final Optional<DeviceDebugPacketIds> oAlarmsPacketIds = Arrays.stream(values()).parallel().filter(a->a.packetId.getId()==id).findAny();

			if(!oAlarmsPacketIds.isPresent())
				logger.warn(id);

			return oAlarmsPacketIds;
		}

		public static Optional<DeviceDebugPacketIds> valueOf(DeviceDebugType deviceDebugType, int index) {
			return Arrays
					.stream(
							values())
					.filter(
							pId->
							pId.packetId.getParameterCode()==deviceDebugType.getParameterCode())
					.filter(
							pId->
							pId.addr!=null)
					.filter(
							pId->
							pId.addr==index)
					.findAny();
		}

		public static Optional<DeviceDebugPacketIds> valueOf(PacketID packetId) {
			return Arrays.stream(values()).filter(pId->pId.packetId.equals(packetId)).findAny();
		}

		public Integer getIndex() {
			return addr;
		}

		@Override
		public String toString(){
			return text;
		}
	}